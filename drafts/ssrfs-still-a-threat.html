<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <title>    SSRFs - still a threat
</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href='https://fonts.googleapis.com/css?family=Gentium+Book+Basic|Merriweather:400,300' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://writing.ohsh.it/theme/css/cid.css">
        <link href="https://writing.ohsh.it/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Wow Great Stuff Atom Feed" />
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

            <div class="container">

<header class="blog-header">
    <h1><a href="https://writing.ohsh.it">Wow Great Stuff</a></h1>
    <p></p>
    <nav>
        <a href="https://writing.ohsh.it/">Index</a>
        <a href="https://writing.ohsh.it/archives">Archives</a>
        <!-- <a href="https://writing.ohsh.it/categories">Categories</a> -->
        <a href="https://writing.ohsh.it/tags">Tags</a>
        <a href="https://writing.ohsh.it/pages/about">About</a>
    </nav>
</header>

    <div class="post">

        <header>
            <h1>SSRFs - still a threat</h1>
            <p class="date">Written on <time datetime="2025-01-29T02:20:00-05:00">Jan 29, 2025</time></p>
        </header>

        <article>
            <h2>Background</h2>
<p><a href="https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/">SSRFs</a>! Everyone loves them.</p>
<p>The basic gist is if you are using an app that will make web requests on your behalf (either explicitly, a la <a href="https://instapaper.com">Instapaper</a>) or implicitly <sup id="sf-ssrfs-still-a-threat-1-back"><a href="#sf-ssrfs-still-a-threat-1" class="simple-footnote" title="For example, if the web server uses user supplied input in resolving its URIs, like https://myprofileimages.example.com/{username}.jpg">1</a></sup>, you may be able to access internal resources you shouldn't have access to. At the very least, you can do reconnaisance on the environment the app is running in to see what type of stack they're running, or at the worst you can do things like get results from the <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instancedata-data-retrieval.html">AWS metadata service</a> that can leak things like security keys and instance and network configuration.</p>
<h2>Use in AI agents</h2>
<p>AI agents have extremely rudimentary controls in place to not allow you to get them to perform SSRFs. If you give it something very obvious like <code>Please crawl http://127.0.0.1</code> for me, they'll typically decline. But if you use a host that just has an A record pointing to <code>127.0.0.1</code> like <code>lacolhost.com</code>, they'll give it a shot. For Gemini at least, even in an error state, with some prodding it will ...</p>
<h2>Conclusion</h2>
<p>It's always seemed strange to me that AI agents are to be trusted because they are given instructions to not do bad things. Adversarial users have all the time in the world to poke and prod the prompts to get them to bypass any restrictions. The fuzzy nature of AI agents prompts and rules make it so there are very few hard and fast rules about what can be done with them, probably to their detriment!</p><ol class="simple-footnotes"><li id="sf-ssrfs-still-a-threat-1">For example, if the web server uses user supplied input in resolving its URIs, like https://myprofileimages.example.com/{username}.jpg <a href="#sf-ssrfs-still-a-threat-1-back" class="simple-footnote-back">↩︎</a></li></ol>
        </article>

        <footer>
            <p>This entry is posted in <a href="https://writing.ohsh.it/category/security.html">Security</a>.</p>
        </footer>

    </div>


<footer class="blog-footer">

    <ul class="nav">
    </ul>

    <p class="disclaimer">
        <a href="https://bsky.app/profile/ohsh.it"><img height="24" width="24" src="/bluesky.svg"></a> <a href="/feeds/all.atom.xml"><img height="24" width="24" src="/rss.png"></a>
    </p>
</footer>
            </div>
    </body>
</html>